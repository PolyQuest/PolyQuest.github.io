## Интерпретатор текстовых квестов с поддержкой HTML и JavaScript
Кратко о PolyQuest:
PolyQuest является модификацией проекта UrqW: https://github.com/narmiel/UrqW/ и, соответственно, обладает всеми возможностями UrqW.
Её точно так же можно скачать и запускать, например, с флешки без интернета. Полную версию со всеми библиотеками и играми в комплекте можно найти здесь: https://github.com/PolyQuest/PolyQuest.github.io/archive/master.zip. Онлайн версия доступна по адресу: http://polyquest.github.io/.

### Дополнительные возможности PolyQuest обеспечивают:
 * Поддержку веб-разметки через тэги <html>...</html>. Можно использовать все те же возможности html, что и для операторов печати, плюс гиперссылки в стиле AkURQ:

   <a href="btn:метка">

   (подробнее см. здесь: http://urq.plut.info/system/files/AkURQ.rar)
   
  * Поддержку выполнения кода JavaScript, который заключается внутри тэгов  <script>...</script>. Все описываемые тэги могут находиться на месте очередного оператора URQL.
  
  * Возможность изменения html-содержимого текущей (работающей) странички. Реализуется несколькими возможными тэгами: <appendContent ... > ... </appendContent>, <appendScript ... > ... </appendScript>, <appendStyle ... > ... </appendStyle>, добавляющими к указанному элементу, соответственно, html-код, js-код и css-разметку. Внутри открывающего тэга указывается один из двух текстовых атрибутов: либо element, значением которого может быть "head" или "body", либо elementId, указывающий id конкретного элемента страницы, к которому добавляется содержимое, расположенное между открывающим и закрывающим тэгами.
  
  * Возможность внедрения переменных URQL в выполняемые фрагменты JavaScript. Объявляются такие переменные с помощью нового оператора let, имеющего вид:
   let <переменная>=<значение>
   или
   let <переменная>
   
  При каждом создании такой переменной её имя заносится в список переменных, доступных для js-кода. При входе в выполняемый участок js- кода значения всех таких переменных передаются внутри JavaScript, а при выходе из него результирующие значения вновь заносятся в одноимённые переменные URQL. Также переменные URQL и JavaScript синхронизируются при каждом входе в поток выполнения кода URQL (в направлении JavaScript -> URQL) и при выходе из него и передаче управления пользователю (в обратном направлении  URQL -> JavaScript).

  * Возможность управления последовательностью проигрывания музыки. С этой целью введена системная локация endmusicloop, заход на которую осуществляется в момент окончания проигрывания музыкальной композиции (с помощью оператора music или js-метода MusicPlay - см. ниже). Таким образом можно зациклить не одну музыкальную композицию, а сразу несколько, выбирая каждую следующую последовательно или случайным образом.
  
  * Возможность осуществления дополнительных действий при сохранении и загрузке игры. Заход на локацию onsave осуществляется до момента сохранения, а заход на локацию onload -- до момента восстановления состояния игры, соответственно. После выполнения всех действий по восстановлению состояния также может осуществляться заход на локацию afterload. Целью подобных действий может быть, например, инициализация каких-то переменных внутри JavaScript, прорисовка графического инвентаря и др.
  
  * Ряд вспомогательных функций JavaScript, осуществляющих взаимодействие с URQL-частью. К ним относятся
  * * readParagraph -- переход на локацию;
  * * UrqExec -- выполнение заданного в качестве параметра кода URQL;
  * * UrqEval -- оценка значения URQL-выражения, заданного в качестве параметра. Работает аналогично выражению if, но внутри скрипта;
  * * MusicPlay -- проигрывание музыкальной композиции (если указан параметр); возобновление проигрывания музыки (если без параметра);
  * * MusicStop -- остановка музыки;
  * * SoundPlay -- проигрывание звукового фрагмента;
  * * SoundStop -- остановка звука.
   
     Надо отметить, что музыка и звуки проигрываются двумя различными потоками. При каждом начале проигрывания звукового фрагмента (оператором sound или js-функцией SoundPlay) музыка приостанавливается, а по его окончании возобновляется вновь.

###  Пример управления потоком кода с помощью JavaScript:
      
:11
<script>
expr_action = 'if (UrqEval("1 Перстень с топазом")) { readParagraph("77"); void(0); } else alert("У Вас нет такой вещи!")';
</script>
<html>
В самом центре Фангорна утопает в зелени дворец эльфийского короля Лориэн. Если у вас есть <a href="javascript: eval(expr_action)">перстень с топазом</a>, можете попытаться увидется с королем##59$ если нет, можете либо <a href=btn:95>обойти дворец стороной</a> либо, надев Кольцо, <a href=btn:119>невидимкой пробраться в королевскую сокровищницу</a>.
</html>

end

Подробнее см. https://github.com/S-presso/S-presso.github.io/blob/master/quests/%D0%9F%D0%BE%D0%B2%D0%B5%D0%BB%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20%D0%A2%D1%8C%D0%BC%D1%8B/Quest.qst


### Как добавить свою игру?
 * Пришлите её мне на почту, spresso4 [@] gmail.com, я очень заинтересован в появлении игр с веб-расширениями. Если речь идёт о том, как добавить игру в репозиторий на своём сайте, то нужно положить квест в папку quests и отредактировать файл games.json
 
### Документация:
 * http://narmiel.github.io/UrqW/docs/urql.html - описание urq language

### Ссылки:
 * http://vk.com/last_elf - быстрая связь с автором расширения (т.е. мной)
 * http://urq.plut.info/ - сайт urq
 * http://quest-book.ru/ - сайт книг-игр, на котором я публикую интерактивные версии книг-игр для PolyQuest
 * https://github.com/PolyQuest/issues - сюда писать о ошибках и пожеланиях
